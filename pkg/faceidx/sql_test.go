package faceidx_test

import (
	"encoding/json"
	"github.com/stretchr/testify/require"
	"github.com/vearutop/photo-blog/pkg/faceidx"
	"testing"
)

func TestCreateFacesTable(t *testing.T) {
	res := faceidx.CreateFacesTable()
	println(res)

	descriptor := [128]float64{
		-0.16648848, -0.05050624, 0.106586605, -0.0867105, -0.09123391, -0.097584575, -0.046739854, -0.103373915, 0.074457884, -0.105268024, 0.20660394, -0.13579035, -0.2745444, 0.0005242062, -0.03232275, 0.18681777, -0.13113116, -0.17754263, -0.052810747, -0.05957584, 0.0062686643, -0.03621107, 0.011501403, 0.1487859, -0.06366991, -0.33826596, -0.06331841, -0.08673793, -0.010200936, -0.0629237, 0.027267495, 0.11619936, -0.2607339, -0.04982499, 0.01518264, 0.12889145, 0.02307811, -0.118307345, 0.1285096, -0.048686076, -0.24529652, -0.12607978, 0.136835, 0.26203102, 0.162219, 0.034145266, 0.018228233, -0.0061597005, 0.040899806, -0.295318, 0.0031301053, 0.06259319, 0.0745079, 0.049838964, 0.00964687, -0.27123472, 0.07631222, 0.060989577, -0.12530015, 0.03486493, 0.035399184, -0.04188027, 0.04090107, -0.051638283, 0.36773872, 0.10492739, -0.14495152, -0.087634355, 0.21060707, -0.16210485, -0.00697436, 0.04431132, -0.16566163, -0.12653385, -0.31701985, -0.06338993, 0.31295794, 0.03408507, -0.17158867, 0.076981254, -0.09508267, 0.073756054, 0.02041351, 0.14637248, -0.0001675617, 0.10626993, -0.08162568, -0.01661037, 0.23682739, -0.021808863, -0.006492801, 0.22029987, -0.01065092, -0.044090617, 0.09562777, 0.039906204, -0.05015147, -0.061895538, -0.21429531, 0.028714905, -0.07911338, -0.017555084, -0.02431442, 0.106665134, -0.20538758, 0.08050651, 0.017503517, -0.0074621206, -0.057238452, 0.036879964, -0.08754097, -0.09878489, 0.111212455, -0.24645737, 0.15643074, 0.21560076, 0.10718059, 0.13916788, 0.05442419, 0.053753562, 0.024602186, -0.011599961, -0.13366313, -0.02042818, 0.062051836, -0.0836075, -0.010100439, 0.07831607,
	}

	insert := faceidx.Insert(descriptor)
	println(insert)

	println(faceidx.SelectSimilar(descriptor))

}

func TestSelectSimilar(t *testing.T) {
	f := [5]string{}

	type res struct {
		Faces []struct {
			Descriptor [128]float64
		} `json:"faces"`
	}

	// IMG_2735
	f[0] = `{"elapsedSec":7.381842853,"found":4,"faces":[{"Rectangle":{"Min":{"X":584,"Y":1228},"Max":{"X":1029,"Y":1673}},"Descriptor":[-0.12220019,0.105114356,0.053581048,0.011272385,-0.09460031,-0.069138765,0.031112034,-0.13960291,0.1618771,-0.10676114,0.17069574,-0.08342825,-0.28006285,-0.018389115,-0.02184515,0.19117631,-0.13141376,-0.13749582,-0.16798238,-0.103078954,0.0012107941,0.06505137,-0.014274135,-0.0022746064,-0.04272137,-0.328965,-0.053227462,-0.04994026,0.04997021,-0.027317664,0.060316846,0.116186365,-0.13172376,-0.06280695,0.11211535,0.08552334,-0.026207127,-0.052834928,0.24091923,-0.0984994,-0.18174103,-0.06374131,0.10635892,0.22506946,0.13760516,0.060108647,0.0004745908,-0.13875106,0.12713894,-0.24918243,0.023379218,0.14397705,-0.010372445,0.073461264,0.10895964,-0.21045393,0.008800451,0.15358992,-0.21843316,-0.00087748165,0.0694893,-0.14284271,-0.09090952,-0.059163332,0.17603211,0.043593798,-0.10581738,-0.111815445,0.27331993,-0.1599887,0.0056470293,0.006302775,-0.06881057,-0.16914181,-0.28580496,0.03712053,0.45847493,0.11030322,-0.13101912,0.04397456,-0.0057603912,-0.034852505,0.0784949,0.06329412,-0.07109991,-0.11227447,-0.082209416,0.0067286044,0.1654452,-0.015854927,0.010492135,0.18082961,0.0063845087,-0.04884944,0.019984,0.065232724,-0.1253016,-0.028290533,-0.18171373,-0.020560723,0.070445605,-0.08534322,0.018555228,0.13306332,-0.14918019,0.11709109,-0.010493284,-0.037380517,-0.009548487,-0.0049048066,-0.0698669,-0.050056607,0.15447658,-0.2043369,0.1873178,0.15009989,-0.03140548,0.20709004,0.041382186,0.1351208,0.0443267,-0.037594847,-0.18908119,-0.14687309,0.0572231,0.042395182,-0.015697576,0.05735984],"Shapes":[{"X":917,"Y":1382},{"X":860,"Y":1379},{"X":707,"Y":1360},{"X":771,"Y":1368},{"X":811,"Y":1499}]},{"Rectangle":{"Min":{"X":2426,"Y":899},"Max":{"X":2798,"Y":1270}},"Descriptor":[-0.08604155,0.021295667,0.03133016,-0.09101359,-0.09232888,0.06311044,0.066074535,-0.056377146,0.06490607,-0.079215094,0.21763416,-0.010148845,-0.28416792,-0.1541867,0.08539161,0.09391502,-0.07013191,-0.12656195,-0.1567873,-0.085680656,-0.040214814,0.055363476,-0.024573669,0.020572687,-0.18818577,-0.3316497,-0.02874465,-0.06683645,-0.04209664,-0.11522083,-0.025948493,0.1083628,-0.13215908,-0.03892629,0.033693425,0.1377705,-0.12856546,-0.05740335,0.17925453,0.036493383,-0.14448288,0.0002586646,0.007002577,0.3544119,0.18821105,0.0038177846,0.05815837,-0.042344406,0.13458708,-0.2628423,0.12729524,0.14802688,0.13501677,0.091351874,0.03406346,-0.11441171,0.045531116,0.10078517,-0.1732122,-0.016526233,0.09375734,-0.12477097,-0.054421697,-0.10721901,0.22820783,0.07703654,-0.13233747,-0.088147655,0.15887007,-0.11995764,-0.09852554,0.0017820373,-0.18478617,-0.12427629,-0.32141852,0.08590638,0.2887596,0.17830774,-0.23109448,-0.075024,-0.13060248,0.091593206,0.09744357,0.048918195,-0.060109682,-0.06234106,-0.08454742,0.045152184,0.19373037,-0.031368505,-0.08751267,0.14075282,0.11913495,-0.057519153,0.086414844,-0.005728889,-0.0705859,-0.040651187,-0.11525032,0.038593046,0.03654029,-0.126858,0.032674044,0.1766603,-0.2146885,0.3316552,0.022452818,-0.0010412522,0.06301448,-0.06158691,-0.08411993,-0.037898354,0.121945515,-0.2623272,0.1429383,0.17950805,0.080313906,0.15267505,0.03757116,0.09043678,-0.10506261,0.015132844,-0.21084657,-0.0946681,0.08789858,0.04137199,0.074399054,0.05618818],"Shapes":[{"X":2707,"Y":1005},{"X":2651,"Y":1004},{"X":2513,"Y":998},{"X":2569,"Y":1000},{"X":2612,"Y":1104}]},{"Rectangle":{"Min":{"X":3417,"Y":1188},"Max":{"X":3788,"Y":1559}},"Descriptor":[-0.12955487,0.056334727,0.07398388,-0.072069205,-0.15554352,-0.052684195,0.024617063,-0.10463529,0.18734601,-0.09276506,0.19306354,0.020981655,-0.32908872,-0.07099976,0.01436482,0.101291396,-0.0809764,-0.095552005,-0.14371577,-0.06740427,0.07853101,-0.019735796,0.11988635,0.015899505,-0.04756259,-0.3525142,-0.072066166,-0.12942323,0.04856236,-0.07323595,0.015062812,-0.026912306,-0.13489212,-0.11236499,-0.02722515,0.06929799,-0.16060093,-0.10278964,0.24000898,-0.013983082,-0.15823798,0.0029630894,-0.041639715,0.18874198,0.19130218,0.04013233,0.10526269,-0.2210052,0.14047085,-0.22078758,0.07371319,0.16464435,0.14822745,0.039705426,0.17849869,-0.13475932,0.11638439,0.15906607,-0.27163276,0.042818498,0.0744998,-0.020109145,-0.04161294,-0.087937,0.18548812,0.08194821,-0.068952784,-0.070250735,0.21503681,-0.12115808,-0.07500716,0.05692537,-0.12855445,-0.19640544,-0.21559699,-0.032976888,0.38571027,0.17539689,-0.16632827,-0.014137941,-0.16766864,-0.05355181,0.0010175061,-0.004492963,-0.14502344,-0.07873458,-0.09913267,0.016931795,0.102003515,-0.061783575,0.025726004,0.22283572,0.111101285,-0.0026305998,0.051480554,-0.005437647,-0.17699236,0.0362514,-0.137847,-0.090735696,0.056228805,-0.18496194,0.06605928,-0.0022322042,-0.26739538,0.18453903,-0.016742663,-0.041153383,-0.0036473107,-0.10501473,-0.10340146,0.05602151,0.18743889,-0.24360476,0.23593034,0.21047208,0.057071023,0.16245471,0.06376425,0.053123515,-0.051514402,-0.06404154,-0.18383218,-0.045522876,0.041596204,0.013848146,0.057167217,0.085577294],"Shapes":[{"X":3701,"Y":1262},{"X":3640,"Y":1267},{"X":3488,"Y":1277},{"X":3550,"Y":1273},{"X":3604,"Y":1373}]},{"Rectangle":{"Min":{"X":4449,"Y":1435},"Max":{"X":4820,"Y":1807}},"Descriptor":[-0.09767164,0.07795955,0.07827478,-0.0929832,-0.16723457,-0.017833132,0.026361946,-0.05608712,0.12385459,-0.0499632,0.18329062,-0.06407725,-0.3263247,0.023043748,-0.095802024,0.12416657,-0.13080527,-0.20996149,-0.10009618,-0.095958084,0.033940483,-0.011938666,-0.08569681,0.037566993,-0.107249126,-0.25027224,-0.02640585,-0.08723109,0.09477407,-0.1869525,-0.04679231,0.0023504982,-0.14246328,-0.09016911,-0.018983783,0.07282859,-0.02402089,-0.15425275,0.22194064,-0.015006142,-0.13609461,-0.008230995,0.05762527,0.34918693,0.13801001,-0.0065638083,0.03307838,0.08579917,0.11389953,-0.33544,0.05406399,0.102586456,0.16188307,0.09504551,0.09533199,-0.17542827,0.023569293,0.16538152,-0.20487326,0.13934605,0.07885289,-0.076915294,0.009359905,-0.08432731,0.26609826,0.07749611,-0.098470554,-0.06957034,0.1768237,-0.14872774,-0.08990372,-0.0301776,-0.08895218,-0.04336467,-0.21278475,0.030870238,0.34944135,0.13800587,-0.20798656,0.011844578,-0.057196796,-0.0017387504,0.04130012,-0.048673622,-0.06241413,0.02777109,-0.1585727,-0.008978649,0.23958911,0.005241164,-0.023241932,0.17708874,0.048183303,-0.08000221,0.09315293,0.049597472,-0.09811268,-0.06145486,-0.08350295,0.043633,0.053905886,-0.18079872,-0.030018397,0.10148774,-0.17655577,0.132224,-0.030817736,0.018020812,-0.08400562,0.0147553105,-0.100844264,0.008637874,0.18915729,-0.2633431,0.19536719,0.21147317,0.004592458,0.067464836,-0.010532324,-0.03833308,0.028352778,0.010634534,-0.09870734,-0.20324658,0.013882857,-0.060962666,0.051962987,0.12482897],"Shapes":[{"X":4752,"Y":1540},{"X":4684,"Y":1538},{"X":4523,"Y":1536},{"X":4583,"Y":1537},{"X":4621,"Y":1657}]}]}`
	// IMG_3085
	f[1] = `{"elapsedSec":6.414491827,"found":1,"faces":[{"Rectangle":{"Min":{"X":2450,"Y":675},"Max":{"X":4047,"Y":2273}},"Descriptor":[-0.07777242,0.050906196,0.0034141038,-0.0020545062,-0.08660876,-0.054919828,0.00051872246,-0.082805805,0.072938085,-0.13897766,0.15008013,-0.096148685,-0.2953609,-0.029824927,0.041090664,0.14912897,-0.16870587,-0.12896045,-0.1814678,-0.15924998,-0.033097126,0.009046905,-0.03838738,-0.010796893,-0.11245112,-0.32698426,-0.101837724,-0.08016822,0.044532456,-0.048932496,0.013212321,0.049035534,-0.10601055,-0.059164878,0.048997782,0.04780744,-0.013181951,-0.09088419,0.20910838,0.00075354055,-0.13627262,-0.04238558,0.07511965,0.28150332,0.1929352,0.081064984,0.03272712,-0.090608746,0.12766619,-0.25735515,0.04060127,0.15495633,0.12376542,0.12680425,0.07539953,-0.09634055,0.103426814,0.08209957,-0.13080972,0.010505981,0.11890362,-0.10897103,-0.038604304,-0.06313066,0.2082875,0.04718925,-0.053969715,-0.094952494,0.16967294,-0.22232713,-0.14031217,-0.034916982,-0.10113735,-0.12680233,-0.337492,-0.0026193503,0.36625677,0.23431747,-0.18695454,-0.0020286422,-0.029285694,0.004743279,0.1742163,0.0743836,-0.11655963,-0.10186346,-0.083056994,0.018842544,0.256281,-0.062400676,-0.040825218,0.12601109,0.052012183,-0.012009021,0.057222776,-0.0034755361,-0.09103553,-0.043358922,-0.0734401,-0.013328094,0.15772146,-0.0978456,0.02689884,0.12873586,-0.2009835,0.19915327,-0.048393976,-0.03260093,0.04916693,0.012631743,-0.06269767,-0.014269669,0.18536012,-0.16014175,0.1374706,0.2537596,-0.055603683,0.1263022,0.04641691,0.1452949,-0.08564829,0.017497443,-0.1976472,-0.16256873,0.03162594,0.04929484,0.042330172,0.027967248],"Shapes":[{"X":3624,"Y":1125},{"X":3324,"Y":1181},{"X":2608,"Y":1295},{"X":2874,"Y":1251},{"X":3152,"Y":1794}]}]}`
	// IMG_2351
	f[2] = `{"elapsedSec":9.400972078,"found":2,"faces":[{"Rectangle":{"Min":{"X":2574,"Y":830},"Max":{"X":2789,"Y":1045}},"Descriptor":[-0.1787918,0.068883166,0.054191194,0.006776787,-0.14171863,-0.11139234,-0.0015697312,-0.044922948,0.14146787,-0.076139,0.16758652,-0.050855625,-0.2518702,-0.012821899,-0.09047675,0.1350754,-0.13378027,-0.14848413,-0.04999108,-0.12997894,0.09669198,0.023069581,-0.07213732,0.04567609,-0.12659149,-0.26615477,-0.057690907,-0.08340013,0.07709511,-0.17675725,0.064070396,0.06882419,-0.07126355,-0.08315367,0.052230965,0.09259111,0.0549641,-0.11138912,0.27876532,-0.01046997,-0.14328873,-0.022438783,-0.003459677,0.37536588,0.064150214,0.01796469,0.07204009,-0.036422938,0.17565905,-0.29682517,0.007195305,0.14339384,0.07450293,0.045205124,0.11896215,-0.18032685,0.06714932,0.13788602,-0.20529994,0.10432658,0.05080766,-0.093919426,0.037822146,-0.05792382,0.22332393,0.030884715,-0.09334888,-0.05572579,0.1622389,-0.17511906,-0.060501326,0.036030494,-0.08613684,-0.12135312,-0.30702347,0.036339164,0.39523473,0.14284988,-0.15477431,0.04849835,0.0018843631,0.011865873,0.08914251,0.078170694,-0.14089125,0.031566888,-0.08236194,0.019543357,0.2317448,0.050130993,-0.06121755,0.18227683,0.051991165,-0.011849562,0.079337835,0.019362677,-0.06211903,-0.09463007,0.006010602,0.06279305,0.13539152,-0.17747696,0.030093245,0.13280712,-0.231051,0.0851503,-0.10362531,-0.010006303,-0.09369265,0.035703655,-0.10576984,0.053190026,0.18408658,-0.26073647,0.19984365,0.244005,-0.028700486,0.13294554,0.013218434,-0.007228256,-0.008949264,0.0014853813,-0.048339065,-0.1450572,0.023319399,-0.038548734,0.053179402,0.032139067],"Shapes":[{"X":2736,"Y":881},{"X":2702,"Y":881},{"X":2614,"Y":893},{"X":2648,"Y":886},{"X":2681,"Y":938}]},{"Rectangle":{"Min":{"X":3175,"Y":222},"Max":{"X":3433,"Y":480}},"Descriptor":[-0.078278325,0.14687389,0.08812847,0.013640655,-0.08848073,0.03071905,0.019611929,0.0033477265,0.10984231,-0.07592714,0.21675509,-0.00586727,-0.25798687,-0.06816705,0.053887025,0.10552907,-0.13724145,-0.1289474,-0.14744395,0.0024642292,0.029156223,0.085484624,-0.034957267,-0.018391846,-0.09336336,-0.44738036,-0.039520558,-0.0049810167,0.02964994,-0.1136035,-0.017002933,0.110488735,-0.06672697,-0.0071107596,0.067115,0.10664013,-0.047013335,-0.08056243,0.21058331,0.029021885,-0.18416534,0.016557802,0.050333742,0.33828136,0.21448126,0.057463925,0.009959767,-0.021517627,0.108738326,-0.25067717,0.060235783,0.1820974,0.09526047,0.0969845,0.091696024,-0.13905898,-0.00023270585,0.041021645,-0.15914842,-0.016732998,0.048042864,-0.1588888,-0.059782304,-0.11551063,0.18854566,0.07339994,-0.10955764,-0.106607325,0.15192235,-0.17901295,-0.09868437,-0.0065742144,-0.14176376,-0.10006704,-0.23642567,0.03955964,0.3755186,0.16353512,-0.22697915,-0.021947285,0.010712746,-0.022602249,0.08471849,0.14899206,-0.090984255,-0.06604545,-0.083692886,0.0328539,0.20644915,0.04203158,-0.06412129,0.18149956,0.06000573,0.015189863,0.08246525,-0.06053431,-0.024605608,-0.045197833,-0.12878154,-0.0036814604,0.04731707,-0.14522049,-0.032381713,0.15166464,-0.17578569,0.20465805,0.010430495,0.04575706,0.110124126,0.014618619,-0.08363821,-0.028596926,0.14801268,-0.22795787,0.15706795,0.17273164,0.031462546,0.12712485,0.04422875,0.12832859,-0.013852907,0.013220248,-0.20319425,-0.117154576,0.028255977,0.0008276636,0.041822046,0.016349519],"Shapes":[{"X":3372,"Y":301},{"X":3331,"Y":304},{"X":3252,"Y":319},{"X":3280,"Y":314},{"X":3289,"Y":383}]}]}`
	// IMG_2419
	f[3] = `{"elapsedSec":11.185179925,"found":2,"faces":[{"Rectangle":{"Min":{"X":2366,"Y":1127},"Max":{"X":2675,"Y":1437}},"Descriptor":[-0.22192532,0.07354331,0.09234805,-0.058389463,-0.13433427,-0.043610126,0.032718718,-0.08885219,0.14527097,-0.12593953,0.14528385,-0.0129495375,-0.25808042,0.10109181,-0.04549396,0.19132061,-0.17536761,-0.18403327,-0.14577022,-0.09940493,-0.055302747,0.04974498,-0.06742501,0.00032124203,-0.12089306,-0.2950003,-0.07718362,-0.037627794,0.01820752,0.02160995,0.07862019,0.07703351,-0.16455704,0.029135983,0.089680046,0.11197974,-0.09139459,-0.1031579,0.27839956,-0.042338718,-0.24003154,-0.053561687,0.11200768,0.24465013,0.16080324,-0.025022313,0.011709413,-0.08815735,0.09637482,-0.32384306,0.017249666,0.19149484,-0.018803857,0.11875924,0.07917461,-0.16312063,0.04467656,0.14913346,-0.15159787,-0.04656612,0.035107523,-0.14450993,-0.02141793,-0.0398372,0.2293301,0.10949145,-0.112439424,-0.13590409,0.22837248,-0.15151757,-0.02633195,0.07135074,-0.07916641,-0.15929604,-0.24334553,0.047574677,0.45404214,0.098832265,-0.08066448,0.073913306,-0.09122859,-0.079159856,0.06943839,0.056747165,-0.08186783,-0.09263379,-0.07249932,0.04319591,0.3100821,-0.030604137,-0.003865254,0.13312712,0.0368194,-0.093916126,0.028909706,0.08339525,-0.09958069,-0.07692462,-0.13695025,-0.048211306,0.08854006,-0.052358232,-0.021303087,0.14666897,-0.21156394,0.14009728,-0.0031502366,-0.08425814,-0.031193083,-0.039913263,-0.06915443,-0.002757902,0.15832232,-0.2082974,0.23992717,0.14019485,-0.08839849,0.17084363,0.076434694,0.03817766,-0.028216101,-0.035855364,-0.12742679,-0.13922088,0.0885637,0.052663453,0.06001259,0.027856588],"Shapes":[{"X":2621,"Y":1224},{"X":2570,"Y":1217},{"X":2440,"Y":1206},{"X":2493,"Y":1210},{"X":2524,"Y":1297}]},{"Rectangle":{"Min":{"X":2985,"Y":1574},"Max":{"X":3294,"Y":1884}},"Descriptor":[-0.08190233,0.044541337,0.015868966,-0.1143912,-0.15652789,-0.011238045,0.04159568,-0.07108913,0.17706734,-0.089918345,0.23206738,0.017457787,-0.37252688,-0.08551243,-0.054469246,0.11326754,-0.07809347,-0.10949546,-0.14638227,-0.12855172,0.06330337,-0.03288966,0.08010756,-0.026578203,-0.10056959,-0.32631257,-0.0788999,-0.09802515,0.0821749,-0.12301853,-0.008236606,-0.0019485877,-0.1268426,-0.09733332,-0.012099446,0.06832114,-0.11865121,-0.09339512,0.208046,0.020376857,-0.1058602,-0.01413555,0.02291387,0.23147237,0.14091279,0.05884304,0.107177526,-0.17388931,0.11443646,-0.25755134,0.13202357,0.12468408,0.15238555,0.04699737,0.20602506,-0.10966812,0.07023452,0.13598222,-0.2134277,0.019620765,0.085559,0.02721079,-0.09161859,-0.12621224,0.20380275,0.06861583,-0.073539615,-0.053022765,0.239066,-0.12440491,-0.06548032,0.024726694,-0.096422054,-0.12331557,-0.22693677,0.04009597,0.36492294,0.19921562,-0.10402982,0.008146582,-0.122350305,-0.0389498,0.014993957,-0.06582298,-0.16297778,-0.032318298,-0.0955392,0.060805872,0.11225255,-0.09482397,0.029625164,0.17922676,0.1045348,0.009384278,0.05889345,0.009319955,-0.17940168,0.010666419,-0.121930525,-0.032920282,0.10136095,-0.16590741,0.061076146,0.02075496,-0.19776702,0.11052109,-0.028901445,-0.08989689,0.0023794733,-0.06916852,-0.10829072,-0.02015081,0.14012875,-0.2638247,0.17904419,0.20300484,0.041312378,0.11010312,0.07389613,0.03969528,-0.011581037,-0.05812476,-0.13947813,-0.084368296,0.039108645,-0.015760627,0.004298335,0.059329625],"Shapes":[{"X":3260,"Y":1665},{"X":3207,"Y":1674},{"X":3067,"Y":1679},{"X":3127,"Y":1679},{"X":3191,"Y":1779}]}]}`
	// IMG_2739
	f[4] = `{"elapsedSec":9.615938176,"found":8,"faces":[{"Rectangle":{"Min":{"X":921,"Y":508},"Max":{"X":1230,"Y":818}},"Descriptor":[-0.08392827,0.13015963,0.07719572,-0.03998435,-0.110738724,-0.03588132,-0.07567781,-0.112622686,0.114817835,-0.025346432,0.20966758,-0.03511229,-0.24004771,-0.012256413,-0.029549684,0.11728484,-0.119081356,-0.11492428,-0.12334646,-0.13360097,0.088263065,0.03452075,0.014794413,0.020845193,-0.14315279,-0.28103775,-0.08282916,-0.061347317,0.12224592,-0.09503351,-0.00059757195,-0.016599987,-0.18896532,-0.040439874,0.067429334,0.11957064,-0.004579896,-0.102260135,0.19503543,-0.08074152,-0.12285036,0.066810854,0.03969483,0.22361171,0.16208073,0.05820238,0.091717035,-0.054449324,0.10622453,-0.17679963,0.071883745,0.14948824,0.11379838,0.060606744,0.080995396,-0.20943365,-0.022554971,0.17613934,-0.14471762,0.028476536,0.052903034,-0.06654057,-0.05843205,-0.11961435,0.2055433,0.09223361,-0.14959383,-0.14573382,0.12373751,-0.14487344,-0.042535458,0.016288294,-0.13937955,-0.04635862,-0.31089765,0.020295113,0.4203191,0.03527887,-0.22873785,0.017443076,-0.030146815,0.032011457,-0.016419178,0.02340052,-0.12600796,0.004495859,-0.10528686,0.03757415,0.20857115,-0.0286575,-0.0047339574,0.13292153,0.0048647644,0.013351641,0.011823955,0.06513665,-0.13816746,-0.081121214,-0.022203574,0.026041029,0.027365115,-0.108985156,-0.027438346,0.12344165,-0.2107247,0.16917269,-0.04313069,-0.010776265,-0.06073827,0.032840263,-0.07774885,0.0023253323,0.18490018,-0.2753763,0.20769261,0.2173021,-0.030115863,0.13293554,0.03135832,0.09432277,-0.017974459,0.083682284,-0.14751577,-0.16313757,-0.013005968,-0.058468547,0.046989147,0.058273077],"Shapes":[{"X":1164,"Y":592},{"X":1113,"Y":588},{"X":985,"Y":574},{"X":1039,"Y":579},{"X":1076,"Y":677}]},{"Rectangle":{"Min":{"X":1574,"Y":818},"Max":{"X":1884,"Y":1127}},"Descriptor":[-0.1542177,0.06476108,0.0057400246,-0.06413571,-0.07576029,-0.05677049,0.040805668,-0.12703912,0.19169784,-0.08559058,0.12285959,-0.022077559,-0.29639286,0.020200355,-0.0021282998,0.1685567,-0.1886456,-0.16239457,-0.10087715,-0.13071191,-0.016944459,0.04310734,-0.023873815,-0.031850148,-0.063321784,-0.3176906,-0.12226042,-0.068043485,0.011444195,0.03269641,0.07140435,0.11941696,-0.16016561,-0.048721038,0.105969444,0.07506037,-0.060166102,-0.07509721,0.23169257,-0.028783968,-0.16945633,-0.037290633,0.120667085,0.1854485,0.17260963,0.049951673,0.017237157,-0.1597864,0.08027907,-0.243116,0.0035380572,0.17718047,-0.011996786,0.07747816,0.07358708,-0.20183492,-0.0044590486,0.10027178,-0.19520946,-0.042943843,0.036207527,-0.1526398,-0.096407995,-0.08004041,0.16231959,0.09016828,-0.08580028,-0.18007901,0.25296095,-0.17518334,-0.061718617,0.049728867,-0.07973154,-0.16069032,-0.28501743,0.028193891,0.38879114,0.09259724,-0.053719334,0.0794179,-0.087070785,-0.06548246,0.014279079,0.042388972,-0.095410645,-0.096980534,-0.079835445,-0.022796772,0.22299898,-0.038023774,-0.01487968,0.12398226,-0.021665443,-0.018366754,0.01712945,0.10889903,-0.14117345,-0.05648686,-0.1758339,-0.120749384,0.0850663,-0.088422336,-0.002694326,0.17428108,-0.20804194,0.10534418,-0.04557971,-0.10479771,-0.048837505,-0.05446897,-0.02849463,0.0008891168,0.15515037,-0.21150479,0.19031067,0.18504922,-0.0750412,0.19903389,0.05920156,0.09495398,-0.066448115,-0.04839655,-0.20900203,-0.14132793,0.044452004,0.12053582,0.006098645,0.038427025],"Shapes":[{"X":1794,"Y":897},{"X":1751,"Y":895},{"X":1640,"Y":887},{"X":1686,"Y":891},{"X":1717,"Y":976}]},{"Rectangle":{"Min":{"X":1850,"Y":474},"Max":{"X":2159,"Y":783}},"Descriptor":[-0.057059396,-0.0070984233,0.07166746,-0.104298286,-0.10666277,-0.025525842,0.06982479,-0.05028732,0.010438138,-0.04384569,0.23758832,-0.03910616,-0.29195774,-0.12961163,0.079449505,0.08335833,-0.063216105,-0.10621312,-0.1707862,-0.07399403,-0.08060188,0.019824494,-0.006310075,-0.041778225,-0.17473397,-0.31012064,-0.060919955,-0.0897741,-0.0002647303,-0.09560352,-0.017188577,0.06872862,-0.1543795,-0.08301023,0.022212442,0.07914427,-0.13132402,-0.09024947,0.17585304,0.0039988356,-0.1539185,-0.016995948,0.06046597,0.2949982,0.15502335,-0.0011040191,0.0675263,-0.0228003,0.09103836,-0.22840495,0.13551506,0.08906107,0.18455234,0.12023271,0.06623209,-0.10763954,0.10665694,0.10093486,-0.26404175,-0.015727444,0.113718905,-0.043720726,-0.073100455,-0.11297716,0.20074844,0.077689186,-0.084423594,-0.10493306,0.1635527,-0.13944991,-0.074682474,0.015805323,-0.14984287,-0.13928856,-0.29587558,0.07199693,0.22613439,0.24131,-0.19984595,-0.034033243,-0.103943065,0.04395913,0.08273289,-0.0460567,-0.06110573,0.019272067,-0.06427055,0.037511885,0.13659239,-0.065995716,-0.07015513,0.11702321,0.09804898,-0.07647294,0.094104595,-0.038106944,-0.07365851,-0.0042628963,-0.1197853,0.050625984,0.07350563,-0.15091924,0.055769943,0.10712488,-0.19020629,0.29757896,0.030713335,-0.023328135,0.023465116,-0.040146172,-0.07265559,-0.040121324,0.12466825,-0.2813664,0.18296419,0.18692335,0.030170241,0.12843487,0.04058627,0.058885388,-0.0966005,0.011514928,-0.18046713,-0.117340334,0.08329135,0.015633944,0.11496219,0.08980402],"Shapes":[{"X":2085,"Y":594},{"X":2043,"Y":588},{"X":1940,"Y":569},{"X":1984,"Y":576},{"X":2009,"Y":659}]},{"Rectangle":{"Min":{"X":2204,"Y":1249},"Max":{"X":2384,"Y":1428}},"Descriptor":[-0.05496293,0.07360527,0.061352637,-0.004561919,-0.09129957,-0.07114391,-0.019347353,-0.051961124,0.06496966,-0.02359784,0.17865711,-0.064606294,-0.25928393,-0.02764793,-0.0029674442,0.11761296,-0.13468672,-0.06847265,-0.13269374,-0.09455421,0.036088157,0.082624376,0.006407205,0.0025662421,-0.010257283,-0.29468623,-0.04218243,-0.078711584,0.07554735,-0.09826139,0.06671056,0.046745367,-0.11763828,-0.02099489,0.008461783,0.05993629,-0.027148878,-0.117917314,0.15119484,-0.014176475,-0.14901137,-0.08691919,0.048914976,0.24599715,0.19659702,0.04082112,0.028228655,-0.05992787,0.07205927,-0.26493338,0.029146615,0.1079014,0.09157518,0.08891447,0.08571776,-0.14659984,0.035363145,0.07940018,-0.12501162,0.04568176,0.09359303,-0.118348554,-0.011239391,-0.12078179,0.20451334,0.034213617,-0.07598657,-0.082429275,0.12150622,-0.1981738,-0.111720376,0.042368904,-0.069443606,-0.097204976,-0.27798113,0.0068212906,0.34161338,0.15451768,-0.14787056,-0.006102504,-0.048720673,0.007616567,0.07127345,0.071631365,-0.055407766,-0.05397848,-0.1246462,-0.00012618303,0.19005041,-0.09017945,0.007979223,0.17950034,-0.022860022,-0.0018317364,-0.0044364245,-0.0035365338,-0.067975536,0.029056158,-0.022448696,0.0013759257,0.089946635,-0.13795187,0.047894575,0.08313222,-0.14870822,0.11524293,-0.030102577,0.022287764,0.08875558,-0.013188298,-0.052687675,-0.041663334,0.19677198,-0.17523712,0.18105514,0.18441467,-0.010445347,0.12755269,0.015051431,0.19769861,-0.0614979,-0.03335944,-0.15003806,-0.07076814,-0.016043305,0.03109792,-0.034162402,0.052131124],"Shapes":[{"X":2335,"Y":1311},{"X":2315,"Y":1306},{"X":2263,"Y":1294},{"X":2285,"Y":1298},{"X":2294,"Y":1347}]},{"Rectangle":{"Min":{"X":2641,"Y":990},"Max":{"X":2950,"Y":1299}},"Descriptor":[-0.07199535,0.049947202,0.04530613,-0.11022959,-0.09478007,-0.060944084,0.024325728,-0.14367343,0.17730944,-0.15772201,0.17683008,-0.11878088,-0.27650785,0.043008003,-0.024249569,0.14035052,-0.18413419,-0.11743119,-0.12355758,-0.046531744,0.028004592,0.07553149,-0.0040267585,0.035287004,-0.054129668,-0.26067844,-0.06561889,-0.112507425,0.0042481376,-0.025111414,0.051230248,0.20443428,-0.10909045,0.0016894173,0.042523343,0.08321903,-0.06844587,-0.1337583,0.26730117,-0.054581065,-0.22508813,-0.114908,0.12267758,0.24717967,0.19263566,-0.026237596,-0.042296432,-0.06063596,0.16359067,-0.3425339,-0.06464442,0.14803547,0.0069012637,0.15614985,0.082285635,-0.18783973,0.13196556,0.092798814,-0.24071431,-0.0067351945,0.08181085,-0.20318468,0.0002813302,-0.061534625,0.289507,0.08118413,-0.11276345,-0.11521367,0.1876316,-0.19668569,-0.08529181,0.12394293,-0.13810971,-0.1554686,-0.20929363,-0.050327737,0.3265009,0.13172057,-0.06148814,0.069846354,-0.06268489,-0.09063061,0.061836474,0.100278884,0.0007058438,-0.050736472,-0.07187643,-0.0072565256,0.28526235,-0.102855,0.028041914,0.2904943,0.0024534585,-0.059131663,-0.012762554,0.009988134,-0.054137893,-0.00750662,-0.15149851,0.037736773,0.049424898,-0.1177993,-0.020822043,0.10899977,-0.23784138,0.13235596,-0.040466435,-0.022496663,-0.013298716,-0.1615504,-0.052558135,0.02649312,0.20025626,-0.2582658,0.17869803,0.13402478,0.0699403,0.14431357,-0.009776078,0.055877868,-0.0052468693,-0.08988926,-0.22068782,-0.09636037,0.1140844,0.032320093,-0.047757782,0.033682432],"Shapes":[{"X":2894,"Y":1057},{"X":2843,"Y":1066},{"X":2718,"Y":1068},{"X":2768,"Y":1069},{"X":2803,"Y":1171}]},{"Rectangle":{"Min":{"X":3060,"Y":1025},"Max":{"X":3318,"Y":1283}},"Descriptor":[-0.11820096,0.12116144,0.069634244,-0.11041566,-0.16142537,0.02801708,-0.029417738,-0.12569074,0.18193696,-0.15772888,0.18986571,-0.055454902,-0.19915377,-0.0061857877,0.04691999,0.15840143,-0.20535769,-0.17742579,-0.09358746,-0.09022881,-0.00046048826,0.117166996,0.022110576,0.087670065,-0.21887013,-0.296565,-0.03369478,-0.115236215,0.04571727,-0.058290664,-0.01880852,0.082108214,-0.1678758,0.0013781171,0.075976014,0.19654933,-0.06060842,-0.09251632,0.15914285,0.025534019,-0.23852544,-0.01395056,0.058367435,0.25429222,0.24394588,-0.03410931,0.0032870267,-0.15466255,0.15265699,-0.29276127,0.080535606,0.16242883,-0.044880018,0.08842976,0.11135196,-0.18734474,0.018694228,0.18275659,-0.17064916,-0.0064579854,0.09466539,-0.067238584,-0.010869535,-0.079680264,0.25082004,0.12675664,-0.12116073,-0.1614276,0.12798478,-0.12024759,-0.11884394,0.1107156,-0.14156511,-0.13942277,-0.2763751,0.063805446,0.43225336,0.111954264,-0.15253167,0.059422992,-0.05967483,-0.0048666634,0.08995384,0.11162632,-0.046675153,-0.057035338,-0.06663426,0.051708456,0.21371318,-0.03713788,0.012735167,0.2134441,-0.019008737,-0.039094,0.07675438,0.06826869,-0.17543446,-0.009886395,-0.17620483,-0.10945369,0.06732861,-0.058336418,-0.012962001,0.15154347,-0.23751256,0.1741952,-0.024262866,-0.08071852,0.021983773,-0.08018639,-0.067115754,-0.0005069368,0.18828152,-0.27278373,0.20258985,0.13299532,0.024423832,0.20232315,0.10769379,0.08876521,-0.029254941,0.0036613466,-0.13909154,-0.04093744,0.10998912,0.0065690717,0.033384275,0.0003287592],"Shapes":[{"X":3235,"Y":1107},{"X":3195,"Y":1114},{"X":3100,"Y":1139},{"X":3138,"Y":1129},{"X":3177,"Y":1191}]},{"Rectangle":{"Min":{"X":3076,"Y":687},"Max":{"X":3291,"Y":902}},"Descriptor":[-0.124908626,0.05261627,0.046681948,-0.05991653,-0.16274603,-0.036539778,0.018316705,-0.094495974,0.1961416,-0.069426015,0.21330395,0.04242243,-0.31503955,-0.08550577,-0.009798684,0.07324975,-0.08702745,-0.11189247,-0.13872686,-0.02347475,0.10165204,-0.042363036,0.10026414,-0.02226573,-0.082685634,-0.36924785,-0.0869801,-0.12142967,0.07411432,-0.07230448,0.022884108,-0.024261706,-0.14252569,-0.10706221,-0.013671505,0.05656831,-0.11034103,-0.08810018,0.21639314,-0.023282975,-0.16600469,-0.007956223,-0.012548851,0.18679641,0.20481549,0.06614602,0.12096705,-0.20908374,0.13086121,-0.21845993,0.089929126,0.15922973,0.1770525,0.027406383,0.19823185,-0.096490234,0.10749733,0.14375283,-0.2590657,0.016732316,0.09394614,0.008815483,-0.068456136,-0.086025104,0.19223289,0.07296488,-0.05806379,-0.086856544,0.23540676,-0.12814806,-0.08640231,0.044032928,-0.1273725,-0.1682154,-0.22936626,-0.037508387,0.4050852,0.16956724,-0.14060616,0.041778374,-0.17577319,-0.02656743,0.0027762575,-0.04793207,-0.13322788,-0.08539543,-0.10758142,0.021356508,0.13281807,-0.07318334,0.046902616,0.17404306,0.10486308,-0.02975722,0.045288846,-0.013467891,-0.1410439,0.04829392,-0.10297719,-0.0635612,0.07248966,-0.13768028,0.08140002,0.0036479337,-0.2611805,0.13536577,-0.013378725,-0.035079304,0.04383019,-0.10894492,-0.09745703,0.027527679,0.148833,-0.29013893,0.23828979,0.17375638,0.02556506,0.13181135,0.04404715,0.06036754,-0.031151453,-0.047342304,-0.1782324,-0.073255725,0.021545019,-0.0011642938,0.030444259,0.07017352],"Shapes":[{"X":3251,"Y":741},{"X":3210,"Y":745},{"X":3108,"Y":745},{"X":3150,"Y":745},{"X":3191,"Y":817}]},{"Rectangle":{"Min":{"X":3576,"Y":939},"Max":{"X":3834,"Y":1197}},"Descriptor":[-0.10030958,0.08614784,0.07105124,-0.0632315,-0.1749508,-0.0023323344,0.011734467,-0.067872256,0.15037593,-0.09945627,0.17611037,-0.029576216,-0.28600204,0.0057937596,-0.14338355,0.15285233,-0.062112264,-0.17780201,-0.112448215,-0.061070003,0.053072024,-0.017715061,-0.048391428,0.070995316,-0.053296052,-0.25769785,-0.04362299,-0.053970203,0.089138046,-0.14010316,-0.02327767,-0.005647209,-0.18975829,-0.061513983,-0.03567297,0.05920958,-0.023742229,-0.14077063,0.2241275,-0.043208074,-0.11984123,0.013965344,0.012837764,0.29775268,0.05949458,-0.0039056698,0.08337365,-0.00784985,0.13906978,-0.3226575,0.015852943,0.066833645,0.093503535,0.035799522,0.085457765,-0.23833899,0.053206764,0.14980671,-0.19244647,0.17506789,-0.007488914,-0.07738376,-0.048453663,-0.06622095,0.2360773,0.10314729,-0.075398214,-0.11402421,0.19435659,-0.15356961,0.043572377,0.04692007,-0.06894541,-0.08282304,-0.2313778,0.03255983,0.46612746,0.13229401,-0.19303022,0.00016082823,-0.056608748,0.035803217,0.059752632,-0.04300801,-0.12048528,0.005325048,-0.20390742,0.045387536,0.23508507,-0.012027856,-0.031061186,0.19167764,0.073874556,-0.039078645,0.053773224,0.06525192,-0.11433841,-0.055129685,-0.06846937,0.06851761,0.088419326,-0.18011789,-0.01707951,0.073147826,-0.15648048,0.07105359,-0.06038864,-0.013038462,-0.07501754,0.05071475,-0.1687733,-0.00010675483,0.17392246,-0.22998604,0.20001224,0.18279871,-0.011431989,0.11095521,0.032043625,0.029984761,0.008412745,-0.016738534,-0.059747785,-0.17248747,0.024960943,-0.05255332,0.05916919,0.07554401],"Shapes":[{"X":3791,"Y":995},{"X":3744,"Y":1001},{"X":3629,"Y":1014},{"X":3673,"Y":1009},{"X":3709,"Y":1089}]}]}`

	var descriptors [][128]float64

	for i := 0; i < len(f); i++ {
		var r res
		require.NoError(t, json.Unmarshal([]byte(f[i]), &r))

		for _, face := range r.Faces {
			descriptors = append(descriptors, face.Descriptor)
		}
	}

	println(faceidx.Insert(descriptors...))

	for i := 0; i < len(descriptors); i++ {
		println(faceidx.SelectSimilar(descriptors[i]))
	}

	println(faceidx.SelectSimilarID(4))
}
