<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{.Title}}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="/static/pure.css">
    <link rel="stylesheet" href="/static/photoswipe.css">

    <script src="/static/jquery-3.6.3.min.js"></script>
    <script src="/static/client.js"></script>
    <script src="/static/photoswipe.umd.min.js"></script>
    <script src="/static/photoswipe-lightbox.umd.min.js"></script>

    <meta property="og:title" content="{{.Title}}" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="{{.CoverImage}}" />

    <meta name="robots" content="noindex">
</head>
<body>

<div style="margin:2em">
    <h1 id="album-title">{{.Title}}</h1>
    <div class="gallery"></div>
    <a href="/album/{{.Name}}.zip">Download all photos (zip).</a>
</div>


<script>
    (function () {
        "use strict";
        var client = new Backend('');

        client.getAlbumNameJson({
            name: "{{.Name}}"
        }, function (result) {
            console.log("OK", result)

            for (var i = 0; i < result.images.length; i++) {
                var img = result.images[i]

                var a = $("<a>")
                a.attr("href", "/images/" + img.hash + ".jpg")
                a.attr("data-pswp-width", 2500)
                a.attr("data-pswp-height", 1667)
                a.attr("target", "_blank")
                a.attr("data-pswp-srcset",
                    "/thumb/300w/" + img.hash + ".jpg 300w, " +
                    "/thumb/600w/" + img.hash + ".jpg 600w, " +
                    "/thumb/1200w/" + img.hash + ".jpg 1200w, " +
                    "/thumb/2400w/" + img.hash + ".jpg 2400w"
                )
                a.html('<img src="/thumb/300w/' + img.hash + '.jpg" srcset="/thumb/600w/' + img.hash + '.jpg 2x" />')

                $(".gallery").append(a)
            }

            var lightbox = new PhotoSwipeLightbox({
                gallery: '.gallery',
                children: 'a',
                // dynamic import is not supported in UMD version
                pswpModule: PhotoSwipe
            });
            lightbox.init();
        }, function (error) {

        }, function (error) {

        })
    })();
</script>
</body>
</html>